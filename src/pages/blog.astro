---
import { readAll } from "../lib/markdoc/read";
import { blog } from "../lib/markdoc/frontmatter.schema";
import PageLayout from "../layouts/PageLayout.astro";
import PageMeta from "../components/PageMeta.astro";
import { SITE_TITLE } from "../config";


async function fetchMediumPosts (){
  const response = await fetch('https://api.rss2json.com/v1/api.json?rss_url=https://medium.com/feed/@marcogarujo');
  const data = await response.json();
  
  if (data.status === 'ok') {
    data.items.forEach((item) => {
      console.log(`Post Tiltle: ${item.title}`);
      console.log(`Post Published at: ${item.pubDate}`);
      console.log(`Post Original Link: ${item.link}`);
      console.log(`Post Author: ${item.author} \n`);
      if(item.thumbnail){
        console.log(`Post Thumbnail: ${item.thumbnail}`);
      }
    });
  }
};
fetchMediumPosts();

const posts = await readAll({
  directory: "blog",
  frontmatterSchema: blog,
});

const sortedPosts = posts
  .filter((p) => p.frontmatter.draft !== true)
  .sort(
    (a, b) =>
      new Date(b.frontmatter.date).valueOf() -
      new Date(a.frontmatter.date).valueOf()
  );
---

<PageLayout>
  <PageMeta title={`Blog | ${SITE_TITLE}`} slot="meta" />
  <section slot="main">
    <ul>
    
    </ul>
  </section>
</PageLayout>
